# ๐ E-Commerce Microservices 

## โจ ุงูููุฑุฉ ูู ุณุทุฑูู (TL;DR)

ุงููุดุฑูุน ุฏู E-Commerce ูุนููู ุจู **Spring Boot + Spring Cloud** ุนูู ุดูู **Microservices**.
ุงูู**Shop Service** ุจุชูุณูู ุงูุฃูุฑุฏุฑ: ุชุณุฃู **Inventory** ุนู ุงูุฃุณุนุงุฑ ูุงูุณุชููุ ุชุณุญุจ ูููุณ ูู **Wallet**ุ ูุจุนุฏูู ุชุฎุตู ุงูุณุชูู. ููู **Gateway** ุจูุนุฏูู ูู ุงูุฑูููุณุชุงุชุ ู**Eureka** ููุงูุชุดุงูุ ู**Config Server** ูููููููุฌ ูู GitHub. ููู **Circuit Breakers** ู**Retry** ุนุดุงู ุงูุณูุณุชู ูุจูู ูุชูุงุณู ุญุชู ูู ููู ุฎุฏูุฉ ููุนุช.

---

## ๐งฉ ุงูุฎุฏูุงุช (ุจุงููุฎุชุตุฑ)

* **API Gateway (8090)**
  Entry point ูุงุญุฏ. ุจููุฒูุน ุงูุฑูููุณุชุงุช ุนูู ุงูุฎุฏูุงุชุ ูุนููู ุฎููู **CircuitBreaker** ุนูู `/wallet` ู`/inventory`.

* **Shop Service (8082)**
  ุงููOrchestrator. ุจูุนูู ุงูุฃูุฑุฏุฑุ ูููู **Wallet** ู**Inventory** ุจู **Feign**. ููู **Resilience4j** + **Compensation** (Refund ูู ุฎุตููุง ูููุณ ูุจุนุฏูู ุงูุณุชูู ูุดู).

* **Wallet Service (8081)**
  ูููุณ ุงูุนููู: **withdraw/deposit**. ูุงุนุฏุฉ ุจูุงูุงุช ูููุตูุฉ.

* **Inventory Service (8083)**
  ููุชุฌุงุช ูุณุชูู: **check** (ุณุนุฑ+ูููุฉ) ู**consume** (ุฎุตู/ุญุฌุฒ). ูุงุนุฏุฉ ุจูุงูุงุช ูููุตูุฉ.

* **Eureka (8761)**
  Service Discovery. ูู ุฎุฏูุฉ ุจุชุณุฌูู ุงุณููุง ููุชูุงูู ุงูุจุงูู ุจุงูู name (lb://...).

* **Config Server (8888)**
  ูููููุฌ ูุฑูุฒู ูู **GitHub repo** (`config/application.yml` + `config/*-service.yml`).

---

## ๐ ุงููWorkflow ุจุชุงุน ุงูุฃูุฑุฏุฑ (ุจุณูุท ููุงุถุญ)

1. **Client โ Gateway**
   ุงูุนููู ูุจุนุช ุนูู `/shop/**`.

2. **Gateway โ Shop**
   ุงูุฌูุชูุงู ููุฌูู ููู **shop-service**.

3. **Shop โ Inventory (check)**
   ูุดูู ูู Product: **ุณุนุฑ + ูููุฉ ูุชุงุญุฉ**. ุงูุฃุณุนุงุฑ ุชูุฌู ูู Inventory (source of truth).

4. **Shop โ Wallet (withdraw)**
   ูู ููู ูุชุงุญุ ูุณุญุจ **ุงูุฅุฌูุงูู** ูู ูุญูุธุฉ ุงูุนููู.

5. **Shop โ Inventory (consume)**
   ูุฎุตู/ูุญุฌุฒ ุงูุณุชูู ูุนูููุง.

6. **ูู ุชูุงู** โ ุงูุฃูุฑุฏุฑ ูุจูู **CONFIRMED** ููุชุณุฌูู.

7. **ูู ุงูุณุชูู ูุดู ุจุนุฏ ุงูุณุญุจ** โ **Compensation**: ูุนูู **Refund** ูููุญูุธุฉ ููุฑุฌูุน Error ูุฑุชุจ.

> โ๏ธ **Resilience**:
>
> * Shop ููู **CircuitBreaker + Retry** ุนูู ููุงููุงุช Feign.
> * Gateway ุนูุฏู **CircuitBreaker** ุนูู `/wallet` ู`/inventory` ุนุดุงู fallback ุธุฑูู ูู ุงูุฎุฏูุงุช ุฏู ููุนุช.
> * `/shop/**` ุจูุณูุจู ุดูุงู ุนุดุงู ูุดูู ุงููclient ุงูุญูููุฉ ูู orchestrator.

---

## ๐ธ๏ธ ุดูู ุงูุชูุงุตู (Mermaid)

```mermaid
graph TD
  C[Client] --> GW[API Gateway]
  GW --> SHOP[Shop Service]
  SHOP -->|Feign| WALLET[Wallet Service]
  SHOP -->|Feign| INV[Inventory Service]
  SHOP --- EUR[Eureka]
  WALLET --- EUR
  INV --- EUR
  GW --- EUR
  SHOP --> CFG[Config Server]
  WALLET --> CFG
  INV --> CFG
  GW --> CFG
```

---

## ๐ ููุงุญุธุงุช ุณุฑูุนุฉ

* **DB per Service**: ูู ุฎุฏูุฉ ุจูุงุนุฏุชูุงุ ูููุด ุฑุจุท ุณูููุงุช.
* **Feign + Eureka**: ููุงููุงุช ุจุงูุงุณู ูุด ุจุงูู IP.
* **Config Server**: ุงููููููุฌ ูู GitHub (shared + per-service).
* **Errors**:

  * **503**: ุฎุฏูุฉ ุชุญุชูุง ูุด ูุชุงุญุฉ (upstream down).
  * **502**: ุงูุฌูุชูุงู ููุฏุฑุด ูููู (timeouts/ุงุณุชุฌุงุจุฉ ุจุงูุธุฉ).
* **Refund Logic**: ูู ุงููููุณ ุงุชุณุญุจุช ูุจุนุฏูู ุงูุณุชูู ููุนุ ุจูุนููุถ ููุฑูุง.

---

## โ๏ธ ุจุงุฎุชุตุงุฑ ุงููุดุฑูุน ุฏู ุฅููุ

ุณูุณุชู ุตุบูุฑ ููุฑููู **ุฅุฒุงู ุชุนูู Order end-to-end** ูู Microservices:
**Check โ Charge โ Reserve โ Confirm**ุ ููุนุงู **ุญููุงูุฉ** (Circuit Breakers/Retry) ู**ุชุนููุถ** (Refund) ูู ุงูุฏููุง ูุจูุฑุช.
ุณูู ุชุชุจุนูุ ููููุน ูู **ููุงูุดุฉ** ุฃู **Portfolio** ๐
